CREATE OR REPLACE PROCEDURE agregar_stock(
barcode_id_ INT,
stock_ INT,
user_ VARCHAR(50)
)
LANGUAGE 'plpgsql'
AS $BODY$
DECLARE STOCK_ACTUAL INT;
BEGIN 
SELECT STOCK INTO STOCK_ACTUAL FROM PRODUCTO WHERE BARCODE_ID = BARCODE_ID_;
STOCK_ = STOCK_ + STOCK_ACTUAL;
UPDATE PRODUCTO SET STOCK = STOCK_ WHERE BARCODE_ID = BARCODE_ID_;
INSERT INTO TRANS (TRANS_TYPE, BARCODE_ID, QTY, TRANS_DATE, USUARIO)
VALUES ('AGREGAR_STOCK', BARCODE_ID_, STOCK_, NOW(), USER_);
END; 
$BODY$;
